{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/Users/Marta/Documents/UNIADRI/Interfaces/SegundaEntrega/app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _regeneratorRuntime from\"C:/Users/Marta/Documents/UNIADRI/Interfaces/SegundaEntrega/app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Marta/Documents/UNIADRI/Interfaces/SegundaEntrega/app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Marta/Documents/UNIADRI/Interfaces/SegundaEntrega/app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from\"react\";import{Link,Route,Routes}from'react-router-dom';import axios from'axios';import{useState,useEffect,useCallback}from'react';import Papa from\"papaparse\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PaginaLectoraCSV=function PaginaLectoraCSV(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),datos=_useState4[0],setDatos=_useState4[1];// This state will store the parsed data\nvar _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),data=_useState6[0],setData=_useState6[1];// Aqui almacenamos si nos ha metido un archivo no valido.\nvar _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];var allowedExtensions=[\"csv\"];var URIRecetas='https://recetap.herokuapp.com/recetas/';var URIInstrucciones='https://recetap.herokuapp.com/instrucciones/';var URIIngredientes='https://recetap.herokuapp.com/ingredientes/';function sleep(milliseconds){var start=new Date().getTime();for(var i=0;i<1e7;i++){if(new Date().getTime()-start>milliseconds){break;}}}// Esta funcion la vamos a llamar cuando se suba el archivo\nvar handleFileChange=function handleFileChange(e){setError(\"\");// Check if user has entered the file\nif(e.target.files.length){var inputFile=e.target.files[0];// Check the file extensions, if it not\n// included in the allowed extensions\n// we show the error\nvar fileExtension=inputFile===null||inputFile===void 0?void 0:inputFile.type.split(\"/\")[1];if(!allowedExtensions.includes(fileExtension)){setError(\"Please input a csv file\");return;}// If input type is correct set the state\nsetFile(inputFile);}};function handleParse(){// If user clicks the parse button without\n// a file we show a error\nif(!file)return setError(\"Enter a valid file\");// Initialize a reader which allows user\n// to read any file or blob.\nvar reader=new FileReader();// Event listener on reader when the file\n// loads, we parse it and set the data.\nreader.onload=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref){var target,csv,parsedData,columns;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:target=_ref.target;csv=Papa.parse(target.result,{header:true});parsedData=csv===null||csv===void 0?void 0:csv.data;columns=Object.keys(parsedData[0]);setData(columns);setDatos(parsedData);almacenar();case 7:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}();reader.readAsText(file);};var almacenar=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var _iterator,_step,receta,responseIngredientes,idIngredientes,responseInstrucciones,idInstrucciones,ver;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_iterator=_createForOfIteratorHelper(datos);_context2.prev=1;_iterator.s();case 3:if((_step=_iterator.n()).done){_context2.next=21;break;}receta=_step.value;console.log(receta);_context2.next=8;return axios.post(URIIngredientes,{ingredientes:receta.Ingredientes});case 8:responseIngredientes=_context2.sent;// Guarda el ID de los ingredientes en la variable idIngredientes\nidIngredientes=responseIngredientes.data.message.pasar.id;// EnvÃ­a la solicitud HTTP para crear las instrucciones\n_context2.next=12;return axios.post(URIInstrucciones,{instruccion:receta.Pasos});case 12:responseInstrucciones=_context2.sent;// Guarda el ID de las instrucciones en la variable idInstrucciones\nidInstrucciones=responseInstrucciones.data.message.pasar.id;_context2.next=16;return axios.post(URIRecetas,{Tittle:receta.Nombre,Ingredients_id:idIngredientes,Instructions_id:idInstrucciones,Image_Name:receta.NombreImagen,comensales:receta.Comensales,tiempo:receta.tiempo});case 16:ver=_context2.sent;console.log(ver);sleep(20);case 19:_context2.next=3;break;case 21:_context2.next=26;break;case 23:_context2.prev=23;_context2.t0=_context2[\"catch\"](1);_iterator.e(_context2.t0);case 26:_context2.prev=26;_iterator.f();return _context2.finish(26);case 29:case\"end\":return _context2.stop();}},_callee2,null,[[1,23,26,29]]);}));return function almacenar(_x2){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"BotonesAr\",nombre:\"Subir Alumnos\",onClick:handleParse,children:\"Subir Archivo\"}),/*#__PURE__*/_jsx(\"input\",{onChange:handleFileChange,id:\"csvInput\",name:\"file\",type:\"File\",className:\"inputBoton\"})]});};export default PaginaLectoraCSV;","map":{"version":3,"names":["React","Link","Route","Routes","axios","useState","useEffect","useCallback","Papa","jsx","_jsx","jsxs","_jsxs","PaginaLectoraCSV","_useState","_useState2","_slicedToArray","file","setFile","_useState3","_useState4","datos","setDatos","_useState5","_useState6","data","setData","_useState7","_useState8","error","setError","allowedExtensions","URIRecetas","URIInstrucciones","URIIngredientes","sleep","milliseconds","start","Date","getTime","i","handleFileChange","e","target","files","length","inputFile","fileExtension","type","split","includes","handleParse","reader","FileReader","onload","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","csv","parsedData","columns","wrap","_callee$","_context","prev","next","parse","result","header","Object","keys","almacenar","stop","_x","apply","arguments","readAsText","_ref3","_callee2","_iterator","_step","receta","responseIngredientes","idIngredientes","responseInstrucciones","idInstrucciones","ver","_callee2$","_context2","_createForOfIteratorHelper","s","n","done","value","console","log","post","ingredientes","Ingredientes","sent","message","pasar","id","instruccion","Pasos","Tittle","Nombre","Ingredients_id","Instructions_id","Image_Name","NombreImagen","comensales","Comensales","tiempo","t0","f","finish","_x2","children","className","nombre","onClick","onChange","name"],"sources":["C:/Users/Marta/Documents/UNIADRI/Interfaces/SegundaEntrega/app/src/paginasOcultas/paginaLectoraCSV.jsx"],"sourcesContent":["import React from \"react\";\n\nimport { Link, Route, Routes } from 'react-router-dom';\nimport axios from 'axios'\nimport { useState, useEffect, useCallback } from 'react'\nimport Papa from \"papaparse\";\n\nconst PaginaLectoraCSV = () => {\n    const [file, setFile] = useState(\"\");\n    const [datos, setDatos] = useState([]);\n    // This state will store the parsed data\n    const [data, setData] = useState([]);\n\n    // Aqui almacenamos si nos ha metido un archivo no valido.\n    const [error, setError] = useState(\"\");\n    const allowedExtensions = [\"csv\"];\n    const URIRecetas = 'https://recetap.herokuapp.com/recetas/'\n    const URIInstrucciones = 'https://recetap.herokuapp.com/instrucciones/'\n    const URIIngredientes = 'https://recetap.herokuapp.com/ingredientes/'\n\n\n    function sleep(milliseconds) {\n        var start = new Date().getTime();\n        for (var i = 0; i < 1e7; i++) {\n            if ((new Date().getTime() - start) > milliseconds) {\n                break;\n            }\n        }\n    }\n    // Esta funcion la vamos a llamar cuando se suba el archivo\n    const handleFileChange = (e) => {\n        setError(\"\");\n\n        // Check if user has entered the file\n        if (e.target.files.length) {\n            const inputFile = e.target.files[0];\n\n            // Check the file extensions, if it not\n            // included in the allowed extensions\n            // we show the error\n            const fileExtension = inputFile?.type.split(\"/\")[1];\n            if (!allowedExtensions.includes(fileExtension)) {\n                setError(\"Please input a csv file\");\n                return;\n            }\n\n            // If input type is correct set the state\n            setFile(inputFile);\n        }\n    };\n    function handleParse() {\n        // If user clicks the parse button without\n        // a file we show a error\n        if (!file) return setError(\"Enter a valid file\");\n\n        // Initialize a reader which allows user\n        // to read any file or blob.\n        const reader = new FileReader();\n\n        // Event listener on reader when the file\n        // loads, we parse it and set the data.\n        reader.onload = async ({ target }) => {\n            const csv = Papa.parse(target.result, { header: true });\n            const parsedData = csv?.data;\n            const columns = Object.keys(parsedData[0]);\n            setData(columns);\n            setDatos(parsedData);\n            almacenar();\n        };\n        reader.readAsText(file);\n    };\n\n    const almacenar = async (e) => {\n        for (const receta of datos) {\n            console.log(receta)\n            const responseIngredientes = await axios.post(URIIngredientes, {\n                ingredientes: receta.Ingredientes\n            })\n    \n            // Guarda el ID de los ingredientes en la variable idIngredientes\n            const idIngredientes = responseIngredientes.data.message.pasar.id\n    \n            // EnvÃ­a la solicitud HTTP para crear las instrucciones\n            const responseInstrucciones = await axios.post(URIInstrucciones, {\n                instruccion: receta.Pasos\n            })\n    \n            // Guarda el ID de las instrucciones en la variable idInstrucciones\n            const idInstrucciones = responseInstrucciones.data.message.pasar.id\n    \n            const ver =await axios.post(URIRecetas, {\n                Tittle: receta.Nombre,\n                Ingredients_id: idIngredientes,\n                Instructions_id: idInstrucciones,\n                Image_Name: receta.NombreImagen,\n                comensales: receta.Comensales,\n                tiempo: receta.tiempo\n            })\n            console.log(ver)\n            sleep(20)\n        }\n\n\n    }\n\n    return (\n        <div>\n            <button className=\"BotonesAr\" nombre=\"Subir Alumnos\" onClick={handleParse}>Subir Archivo</button>\n            <input\n                onChange={handleFileChange}\n                id=\"csvInput\"\n                name=\"file\"\n                type=\"File\"\n                className=\"inputBoton\"\n            />\n        </div>\n    )\n}\nexport default PaginaLectoraCSV"],"mappings":"wnBAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CAEzB,OAASC,IAAI,CAAEC,KAAK,CAAEC,MAAM,KAAQ,kBAAkB,CACtD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,CAAEC,SAAS,CAAEC,WAAW,KAAQ,OAAO,CACxD,MAAO,CAAAC,IAAI,KAAM,WAAW,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAE7B,GAAM,CAAAC,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAA,CAAS,CAC3B,IAAAC,SAAA,CAAwBT,QAAQ,CAAC,EAAE,CAAC,CAAAU,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA7BG,IAAI,CAAAF,UAAA,IAAEG,OAAO,CAAAH,UAAA,IACpB,IAAAI,UAAA,CAA0Bd,QAAQ,CAAC,EAAE,CAAC,CAAAe,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA/BE,KAAK,CAAAD,UAAA,IAAEE,QAAQ,CAAAF,UAAA,IACtB;AACA,IAAAG,UAAA,CAAwBlB,QAAQ,CAAC,EAAE,CAAC,CAAAmB,UAAA,CAAAR,cAAA,CAAAO,UAAA,IAA7BE,IAAI,CAAAD,UAAA,IAAEE,OAAO,CAAAF,UAAA,IAEpB;AACA,IAAAG,UAAA,CAA0BtB,QAAQ,CAAC,EAAE,CAAC,CAAAuB,UAAA,CAAAZ,cAAA,CAAAW,UAAA,IAA/BE,KAAK,CAAAD,UAAA,IAAEE,QAAQ,CAAAF,UAAA,IACtB,GAAM,CAAAG,iBAAiB,CAAG,CAAC,KAAK,CAAC,CACjC,GAAM,CAAAC,UAAU,CAAG,wCAAwC,CAC3D,GAAM,CAAAC,gBAAgB,CAAG,8CAA8C,CACvE,GAAM,CAAAC,eAAe,CAAG,6CAA6C,CAGrE,QAAS,CAAAC,KAAKA,CAACC,YAAY,CAAE,CACzB,GAAI,CAAAC,KAAK,CAAG,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAChC,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAG,GAAG,CAAEA,CAAC,EAAE,CAAE,CAC1B,GAAK,GAAI,CAAAF,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAAGF,KAAK,CAAID,YAAY,CAAE,CAC/C,MACJ,CACJ,CACJ,CACA;AACA,GAAM,CAAAK,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAIC,CAAC,CAAK,CAC5BZ,QAAQ,CAAC,EAAE,CAAC,CAEZ;AACA,GAAIY,CAAC,CAACC,MAAM,CAACC,KAAK,CAACC,MAAM,CAAE,CACvB,GAAM,CAAAC,SAAS,CAAGJ,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAEnC;AACA;AACA;AACA,GAAM,CAAAG,aAAa,CAAGD,SAAS,SAATA,SAAS,iBAATA,SAAS,CAAEE,IAAI,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACnD,GAAI,CAAClB,iBAAiB,CAACmB,QAAQ,CAACH,aAAa,CAAC,CAAE,CAC5CjB,QAAQ,CAAC,yBAAyB,CAAC,CACnC,OACJ,CAEA;AACAZ,OAAO,CAAC4B,SAAS,CAAC,CACtB,CACJ,CAAC,CACD,QAAS,CAAAK,WAAWA,CAAA,CAAG,CACnB;AACA;AACA,GAAI,CAAClC,IAAI,CAAE,MAAO,CAAAa,QAAQ,CAAC,oBAAoB,CAAC,CAEhD;AACA;AACA,GAAM,CAAAsB,MAAM,CAAG,GAAI,CAAAC,UAAU,CAAC,CAAC,CAE/B;AACA;AACAD,MAAM,CAACE,MAAM,6BAAAC,KAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAAC,IAAA,MAAAjB,MAAA,CAAAkB,GAAA,CAAAC,UAAA,CAAAC,OAAA,QAAAN,mBAAA,GAAAO,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAASzB,MAAM,CAAAiB,IAAA,CAANjB,MAAM,CACrBkB,GAAG,CAAGrD,IAAI,CAAC6D,KAAK,CAAC1B,MAAM,CAAC2B,MAAM,CAAE,CAAEC,MAAM,CAAE,IAAK,CAAC,CAAC,CACjDT,UAAU,CAAGD,GAAG,SAAHA,GAAG,iBAAHA,GAAG,CAAEpC,IAAI,CACtBsC,OAAO,CAAGS,MAAM,CAACC,IAAI,CAACX,UAAU,CAAC,CAAC,CAAC,CAAC,CAC1CpC,OAAO,CAACqC,OAAO,CAAC,CAChBzC,QAAQ,CAACwC,UAAU,CAAC,CACpBY,SAAS,CAAC,CAAC,CAAC,wBAAAR,QAAA,CAAAS,IAAA,MAAAhB,OAAA,GACf,mBAAAiB,EAAA,SAAArB,KAAA,CAAAsB,KAAA,MAAAC,SAAA,QACD1B,MAAM,CAAC2B,UAAU,CAAC9D,IAAI,CAAC,CAC3B,CAAC,CAED,GAAM,CAAAyD,SAAS,6BAAAM,KAAA,CAAAxB,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAuB,SAAOvC,CAAC,MAAAwC,SAAA,CAAAC,KAAA,CAAAC,MAAA,CAAAC,oBAAA,CAAAC,cAAA,CAAAC,qBAAA,CAAAC,eAAA,CAAAC,GAAA,QAAAhC,mBAAA,GAAAO,IAAA,UAAA0B,UAAAC,SAAA,iBAAAA,SAAA,CAAAxB,IAAA,CAAAwB,SAAA,CAAAvB,IAAA,SAAAc,SAAA,CAAAU,0BAAA,CACDvE,KAAK,EAAAsE,SAAA,CAAAxB,IAAA,GAAAe,SAAA,CAAAW,CAAA,cAAAV,KAAA,CAAAD,SAAA,CAAAY,CAAA,IAAAC,IAAA,EAAAJ,SAAA,CAAAvB,IAAA,WAAfgB,MAAM,CAAAD,KAAA,CAAAa,KAAA,CACbC,OAAO,CAACC,GAAG,CAACd,MAAM,CAAC,CAAAO,SAAA,CAAAvB,IAAA,SACgB,CAAAhE,KAAK,CAAC+F,IAAI,CAACjE,eAAe,CAAE,CAC3DkE,YAAY,CAAEhB,MAAM,CAACiB,YACzB,CAAC,CAAC,QAFIhB,oBAAoB,CAAAM,SAAA,CAAAW,IAAA,CAI1B;AACMhB,cAAc,CAAGD,oBAAoB,CAAC5D,IAAI,CAAC8E,OAAO,CAACC,KAAK,CAACC,EAAE,CAEjE;AAAAd,SAAA,CAAAvB,IAAA,UACoC,CAAAhE,KAAK,CAAC+F,IAAI,CAAClE,gBAAgB,CAAE,CAC7DyE,WAAW,CAAEtB,MAAM,CAACuB,KACxB,CAAC,CAAC,SAFIpB,qBAAqB,CAAAI,SAAA,CAAAW,IAAA,CAI3B;AACMd,eAAe,CAAGD,qBAAqB,CAAC9D,IAAI,CAAC8E,OAAO,CAACC,KAAK,CAACC,EAAE,CAAAd,SAAA,CAAAvB,IAAA,UAElD,CAAAhE,KAAK,CAAC+F,IAAI,CAACnE,UAAU,CAAE,CACpC4E,MAAM,CAAExB,MAAM,CAACyB,MAAM,CACrBC,cAAc,CAAExB,cAAc,CAC9ByB,eAAe,CAAEvB,eAAe,CAChCwB,UAAU,CAAE5B,MAAM,CAAC6B,YAAY,CAC/BC,UAAU,CAAE9B,MAAM,CAAC+B,UAAU,CAC7BC,MAAM,CAAEhC,MAAM,CAACgC,MACnB,CAAC,CAAC,SAPI3B,GAAG,CAAAE,SAAA,CAAAW,IAAA,CAQTL,OAAO,CAACC,GAAG,CAACT,GAAG,CAAC,CAChBtD,KAAK,CAAC,EAAE,CAAC,SAAAwD,SAAA,CAAAvB,IAAA,iBAAAuB,SAAA,CAAAvB,IAAA,kBAAAuB,SAAA,CAAAxB,IAAA,IAAAwB,SAAA,CAAA0B,EAAA,CAAA1B,SAAA,aAAAT,SAAA,CAAAxC,CAAA,CAAAiD,SAAA,CAAA0B,EAAA,UAAA1B,SAAA,CAAAxB,IAAA,IAAAe,SAAA,CAAAoC,CAAA,UAAA3B,SAAA,CAAA4B,MAAA,8BAAA5B,SAAA,CAAAhB,IAAA,MAAAM,QAAA,uBAIhB,kBA/BK,CAAAP,SAASA,CAAA8C,GAAA,SAAAxC,KAAA,CAAAH,KAAA,MAAAC,SAAA,OA+Bd,CAED,mBACIlE,KAAA,QAAA6G,QAAA,eACI/G,IAAA,WAAQgH,SAAS,CAAC,WAAW,CAACC,MAAM,CAAC,eAAe,CAACC,OAAO,CAAEzE,WAAY,CAAAsE,QAAA,CAAC,eAAa,CAAQ,CAAC,cACjG/G,IAAA,UACImH,QAAQ,CAAEpF,gBAAiB,CAC3BgE,EAAE,CAAC,UAAU,CACbqB,IAAI,CAAC,MAAM,CACX9E,IAAI,CAAC,MAAM,CACX0E,SAAS,CAAC,YAAY,CACzB,CAAC,EACD,CAAC,CAEd,CAAC,CACD,cAAe,CAAA7G,gBAAgB"},"metadata":{},"sourceType":"module","externalDependencies":[]}